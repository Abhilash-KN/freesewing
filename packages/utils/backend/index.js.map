{"version":3,"file":"index.js","sources":["../src/backend/index.js"],"sourcesContent":["import axios from 'axios'\r\n\r\nfunction useBackend(baseURL, timeout = 10000) {\r\n  // Configure Axios\r\n  const api = axios.create({ baseURL, timeout })\r\n\r\n  // Helper method for Authorization header\r\n  const auth = token => ({\r\n    headers: { Authorization: 'Bearer ' + token }\r\n  })\r\n\r\n  const backend = {}\r\n\r\n  // Oauth\r\n  backend.initOauth = data => api.post('/oauth/init', data) // Init Oauth (to get state)\r\n  backend.providerLogin = data => api.post('/oauth/login', data) // Finalize Oauth login\r\n\r\n  // Signup flow\r\n  backend.signup = (email, password, language) => api.post('/signup', { email, password, language }) // Signup\r\n  backend.confirm = confirmId => api.post('/account', { id: confirmId }) // Confirm\r\n  backend.createAccount = (confirmId, consent) => api.post('/account', { id: confirmId, consent }) // Create account\r\n  backend.resendActivationEmail = (email, language) => api.post('/resend', { email, language }) // Re-send activation email\r\n\r\n  // Other non-authenticated calls\r\n  backend.login = (username, password) => api.post('/login', { username, password }) // Login\r\n  backend.confirmationLogin = id => api.post('/confirm/login', { id }) // Confirmation-based login\r\n  backend.recoverAccount = username => api.post('/account/recover', { username: username }) // Ask for a password reset\r\n  backend.loadPattern = handle => api.get('/pattern/' + handle) // Load pattern anonymously\r\n  backend.loadPatrons = handle => api.get('/patrons') // Load patron list\r\n\r\n  // Users\r\n  backend.profile = (username, token) => api.get('/users/' + username, auth(token)) // Load user profile\r\n  backend.account = token => api.get('/account', auth(token)) // Try to authenticate based on stored token\r\n  backend.export = token => api.get('/account/export', auth(token)) // Export data\r\n  backend.restrict = token => api.get('/account/restrict', auth(token)) // Restrict data processing (freeze account)\r\n  backend.remove = token => api.delete('/account', auth(token)) // Remove account\r\n  backend.saveAccount = (data, token) => api.put('/account', data, auth(token)) // Update account\r\n  backend.availableUsername = (data, token) => api.post('/available/username', data, auth(token)) // Check is a username is available\r\n  backend.setPassword = (data, token) => api.post('/set/password', data, auth(token)) // (re)set a new password\r\n\r\n  // People\r\n  backend.createPerson = (data, token) => api.post('/people', data, auth(token)) // Create person\r\n  backend.savePerson = (handle, data, token) => api.put('/people/' + handle, data, auth(token)) // Update person\r\n  backend.removePerson = (handle, token) => api.delete('/people/' + handle, auth(token)) // Remove person\r\n\r\n  // Patterns\r\n  backend.loadPattern = (handle, token) => api.get('/patterns/' + handle, auth(token)) // Load pattern\r\n  backend.createPattern = (data, token) => api.post('/patterns', data, auth(token)) // Create pattern\r\n  backend.removePattern = (handle, token) => api.delete('/patterns/' + handle, auth(token)) // Remove pattern\r\n  backend.savePattern = (handle, data, token) => api.put('/patterns/' + handle, data, auth(token)) // Update pattern\r\n\r\n  // Admin\r\n  backend.adminSearch = (query, token) => api.post('/admin/search', { query }, auth(token)) // Search users as admin\r\n  backend.adminSetPatronStatus = (data, token) => api.put('/admin/patron', data, auth(token)) // Set patron status for a user\r\n  backend.adminSetRole = (data, token) => api.put('/admin/role', data, auth(token)) // Set role for a user\r\n  backend.adminUnfreeze = (data, token) => api.put('/admin/unfreeze', data, auth(token)) // Unfreeze a user account\r\n  backend.adminImpersonate = (data, token) => api.post('/admin/impersonate', data, auth(token)) // Impersonate a user\r\n\r\n  return backend\r\n}\r\n\r\nexport default useBackend\r\n"],"names":["useBackend","baseURL","timeout","api","axios","create","auth","token","headers","Authorization","backend","initOauth","data","post","providerLogin","signup","email","password","language","confirm","confirmId","id","createAccount","consent","resendActivationEmail","login","username","confirmationLogin","recoverAccount","loadPattern","handle","get","loadPatrons","profile","account","export","restrict","remove","delete","saveAccount","put","availableUsername","setPassword","createPerson","savePerson","removePerson","createPattern","removePattern","savePattern","adminSearch","query","adminSetPatronStatus","adminSetRole","adminUnfreeze","adminImpersonate"],"mappings":"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"}