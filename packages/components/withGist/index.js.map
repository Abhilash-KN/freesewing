{"version":3,"file":"index.js","sources":["../src/withGist/index.js"],"sourcesContent":["import React from \"react\";\r\nimport storage from \"@freesewing/utils/storage\";\r\n\r\nconst withGist = (WrappedComponent, settings = { gist: {}, store: false }) => {\r\n  return class extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.setGist = this.setGist.bind(this);\r\n      this.importGist = this.importGist.bind(this);\r\n      this.updateGist = this.updateGist.bind(this);\r\n      this.state = { gist: settings.gist || {} };\r\n    }\r\n\r\n    setGist(gist) {\r\n      this.setState({ gist });\r\n      if (settings.store) storage.set(this.state.gist.name || \"gist\", gist);\r\n    }\r\n\r\n    importGist(gist) {\r\n      if (typeof this.state.gist.settings === \"undefined\")\r\n        this.updateGist({}, \"settings\");\r\n      if (typeof this.state.gist.settings.options === \"undefined\")\r\n        this.updateGist({}, \"settings\", \"options\");\r\n      if (typeof gist.settings !== \"undefined\") {\r\n        // Load settings\r\n        for (let key of Object.keys(gist.settings)) {\r\n          if (key !== \"options\")\r\n            this.updateGist(gist.settings[key], \"settings\", key);\r\n        }\r\n        if (typeof gist.settings.options !== \"undefined\") {\r\n          // Load options\r\n          for (let key of Object.keys(gist.settings.options)) {\r\n            this.updateGist(\r\n              gist.settings.options[key],\r\n              \"settings\",\r\n              \"options\",\r\n              key\r\n            );\r\n          }\r\n        }\r\n      }\r\n      // Load root level keys\r\n      for (let key of Object.keys(gist)) {\r\n        if (key !== \"settings\") this.updateGist(gist[key], key);\r\n      }\r\n    }\r\n\r\n    updateGist(value, l1 = false, l2 = false, l3 = false) {\r\n      if (!l1) return;\r\n      let gist = this.state.gist;\r\n\r\n      if (l2 && typeof gist[l1] === \"undefined\") gist[l1] = {};\r\n      if (l3 && typeof gist[l1][l2] === \"undefined\") gist[l1][l2] = {};\r\n\r\n      if (l3) gist[l1][l2][l3] = value;\r\n      else if (l2) gist[l1][l2] = value;\r\n      else gist[l1] = value;\r\n      this.setState({ gist });\r\n      if (settings.store) storage.set(this.state.gist.name || \"gist\", gist);\r\n    }\r\n\r\n    render() {\r\n      return (\r\n        <WrappedComponent\r\n          gist={this.state.gist}\r\n          importGist={this.importGist}\r\n          updateGist={this.updateGist}\r\n          {...this.props}\r\n        />\r\n      );\r\n    }\r\n  };\r\n};\r\n\r\nexport default withGist;\r\n"],"names":["withGist","WrappedComponent","settings","gist","store","props","setGist","_this","bind","importGist","updateGist","state","setState","storage","set","name","options","key","Object","keys","value","l1","l2","l3","React","Component"],"mappings":"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"}